<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Sueldo Vigilador</title>

  <!-- Android barras oscuras -->
  <meta name="color-scheme" content="dark light">
  <meta name="theme-color" content="#161821" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#161821" media="(prefers-color-scheme: dark)">

  <link rel="stylesheet" href="style.css" />

  <!-- ==== UI Bot flotante (estilos aislados) ==== -->
  <style>
    /* Prefijo sv- para no chocar con tu CSS */
    .sv-chat-launcher{
      position:fixed; top:40%; right:12px; z-index:9999;
      display:flex; flex-direction:column; align-items:flex-end; gap:8px;
    }
    .sv-chat-btn{
      width:58px;height:58px;border-radius:50%;
      background:#25d366; color:#fff; border:none; box-shadow:0 8px 24px rgba(0,0,0,.18);
      display:grid; place-items:center; cursor:pointer; transition:transform .12s ease, box-shadow .12s ease;
    }
    .sv-chat-btn:hover{ transform:translateY(-1px); box-shadow:0 10px 28px rgba(0,0,0,.22) }
    .sv-chat-btn:active{ transform:translateY(0) }
    .sv-chat-btn svg{ width:28px; height:28px }

    .sv-tooltip{
      max-width:220px; padding:10px 12px; font-size:13px; line-height:1.35;
      background:#fff; color:#1f2937; border-radius:14px; box-shadow:0 10px 24px rgba(0,0,0,.16);
      border:1px solid rgba(0,0,0,.06);
      position:relative; opacity:0; transform:translateX(8px);
      transition:opacity .22s ease, transform .22s ease;
    }
    .sv-tooltip.show{ opacity:1; transform:translateX(0) }
    .sv-tooltip.hide{ opacity:0; transform:translateX(8px) }
    .sv-tooltip::after{
      content:""; position:absolute; right:8px; top:50%; transform:translateY(-50%);
      border-left:8px solid #fff; border-top:8px solid transparent; border-bottom:8px solid transparent;
      filter:drop-shadow(0 1px 0 rgba(0,0,0,.06));
    }

    /* Modal */
    .sv-modal{ position:fixed; inset:0; z-index:10000; display:none; }
    .sv-modal.show{ display:block }
    .sv-backdrop{ position:absolute; inset:0; background:rgba(0,0,0,.35); backdrop-filter:blur(2px); }
    .sv-sheet{
      position:absolute; inset:auto 10px 10px auto;
      width:min(480px, 96vw); height:min(84vh, 96vh);
      background:#0f172a; color:#e5e7eb; border-radius:22px;
      box-shadow:0 16px 40px rgba(0,0,0,.35); overflow:hidden;
      border:1px solid rgba(255,255,255,.06);
    }
    @media (max-width:560px){
      .sv-sheet{ inset: 10px 10px 10px 10px; width:auto; height:auto; }
    }
    .sv-body{ height:100%; }
    .sv-body iframe{ width:100%; height:100%; border:0; display:block; background:#111827 }

    /* Botón cerrar flotante (sin header extra) */
    .sv-close{
      position:absolute; top:10px; right:10px; z-index:2;
      background:rgba(17,24,39,.7); color:#e5e7eb; border:1px solid rgba(255,255,255,.16);
      border-radius:12px; padding:6px 10px; cursor:pointer; backdrop-filter:saturate(140%) blur(2px);
    }
    .sv-close:hover{ background:rgba(17,24,39,.85) }

    /* Respetar notch */
    @supports(padding:max(0px)){
      .sv-sheet{ padding-bottom: max(0px, env(safe-area-inset-bottom)); }
    }
  </style>
</head>
<body>
  <div id="app">
    <!-- MODAL de modo de cálculo -->
    <div class="modal show" id="modal-modo">
      <div class="modal-card">
        <div class="brand">
          <img src="https://cdn.jsdelivr.net/gh/sanavera/sueldo-vigilador-web@main/ic_launcher.png" alt="" />
          <h1>Sueldo <span>Vigilador</span></h1>
        </div>
        <p class="lead">¿Cómo querés calcular tu sueldo?</p>
        <p class="sub">Elegí la modalidad que usás para calcularlo de forma más precisa.</p>
        <div class="btn-col">
          <button id="btn-modo-dias" class="btn btn-brand">Por días trabajados</button>
          <button id="btn-modo-horas" class="btn btn-accent">Por horas trabajadas</button>
          <button id="btn-acerca" class="btn btn-ghost">Acerca de</button>
        </div>
      </div>
    </div>

    <!-- CABECERA -->
    <header class="header">
      <div class="brand">
        <img src="https://cdn.jsdelivr.net/gh/sanavera/sueldo-vigilador-web@main/ic_launcher.png" alt="" />
        <h1>Sueldo <span>Vigilador</span></h1>
      </div>
      <button id="btn-nuevo" class="chip">Nuevo cálculo</button>
    </header>

    <!-- FORMULARIOS -->
    <main class="content">
      <!-- MODO DÍAS -->
      <section id="form-dias" class="card hide">
        <div class="grid">
          <label class="field">
            <span>Días trabajados</span>
            <input id="diasTrabajados" type="number" min="0" inputmode="numeric" placeholder="Ej. 21" />
          </label>

          <label class="field">
            <span>▼ Horas por día</span>
            <select id="horasPorDia">
              <option value="12">12 horas</option>
              <option value="10">10 horas</option>
              <option value="8">8 horas</option>
            </select>
          </label>

          <label class="field">
            <span>Días feriados</span>
            <input id="diasFeriados" type="number" min="0" inputmode="numeric" placeholder="Ej. 1" />
          </label>

          <label class="field">
            <span>▼ Pago feriado</span>
            <select id="pagoFeriado">
              <option value="0">4h al 100% + 8h normal (12h)</option>
              <option value="1">12h al 100% (12h)</option>
              <option value="2">Jornada completa al 100% (8/10h)</option>
            </select>
          </label>

          <label class="field">
            <span>Años de antigüedad</span>
            <input id="aniosAnt" type="number" min="0" inputmode="numeric" placeholder="Ej. 1" />
          </label>

          <div class="checks">
            <label class="check">
              <input id="turnoNocheDias" type="checkbox" />
              <span>Turno noche</span>
            </label>
            <label class="check">
              <input id="sindicatoDias" type="checkbox" />
              <span>Sindicato</span>
            </label>
          </div>

          <label id="diasNocturnosWrap" class="field hide">
            <span>Días nocturnos</span>
            <input id="diasNocturnosDias" type="number" min="0" inputmode="numeric" placeholder="Igual a días trabajados" />
          </label>
        </div>

        <div class="cta">
          <button id="btn-calcular-dias" class="btn btn-brand">Calcular sueldo</button>
          <button id="btn-opciones" class="btn btn-accent">Opciones avanzadas</button>
        </div>

        <div id="resultado-dias" class="resultado hide">
          <div class="neto" id="neto-dias"></div>
          <div class="bruto" id="bruto-dias"></div>
          <div class="alt" id="alt-dias"></div>
          <button id="btn-detalle-dias" class="btn btn-ghost">Ver detalle completo</button>
        </div>
      </section>

      <!-- MODO HORAS -->
      <section id="form-horas" class="card hide">
        <div class="grid">
          <label class="field">
            <span>Horas totales del mes</span>
            <input id="horasTotales" type="number" min="0" inputmode="numeric" placeholder="Ej. 240" />
          </label>

          <label class="field">
            <span>Días feriados</span>
            <input id="diasFeriadosHoras" type="number" min="0" inputmode="numeric" placeholder="Ej. 1" />
          </label>

          <label class="field">
            <span>Días nocturnos</span>
            <input id="diasNocturnos" type="number" min="0" inputmode="numeric" placeholder="Ej. 20" />
          </label>

          <label class="field">
            <span>Años de antigüedad</span>
            <input id="aniosAntHoras" type="number" min="0" inputmode="numeric" placeholder="Ej. 1" />
          </label>

          <div class="checks">
            <label class="check">
              <input id="sindicatoHoras" type="checkbox" />
              <span>Sindicato</span>
            </label>
          </div>
        </div>

        <div class="cta">
          <button id="btn-calcular-horas" class="btn btn-brand">Calcular sueldo</button>
          <button id="btn-opciones-2" class="btn btn-accent">Opciones avanzadas</button>
        </div>

        <div id="resultado-horas" class="resultado hide">
          <div class="neto" id="neto-horas"></div>
          <div class="bruto" id="bruto-horas"></div>
          <button id="btn-detalle-horas" class="btn btn-ghost">Ver detalle completo</button>
        </div>
      </section>
    </main>

    <!-- MODAL Detalle -->
    <div class="modal" id="modal-detalle">
      <div class="modal-card lg">
        <pre id="detalle-pre" class="detalle"></pre>
        <div class="modal-actions">
          <button id="btn-cerrar-detalle" class="btn btn-ghost">Cerrar</button>
          <button id="btn-copiar" class="btn btn-accent">Copiar</button>
        </div>
      </div>
    </div>

    <!-- MODAL Opciones avanzadas -->
    <div class="modal" id="modal-opciones">
      <div class="modal-card">
        <h2>Opciones avanzadas</h2>
        <div class="grid">
          <!-- Spinner de Escala salarial -->
          <label class="field">
            <span>▼ Escala salarial</span>
            <select id="escalaMes"></select>
          </label>

          <label class="field">
            <span>Horas extras desde</span>
            <select id="horasExtrasDesde">
              <option value="192">192</option>
              <option value="200">200</option>
              <option value="208" selected>208</option>
            </select>
          </label>

          <label class="field"><span>Hora normal</span><input id="vHora" type="number" step="0.01"></label>
          <label class="field"><span>Hora extra 50%</span><input id="vHora50" type="number" step="0.01"></label>
          <label class="field"><span>Hora extra 100%</span><input id="vHora100" type="number" step="0.01"></label>
          <label class="field"><span>Hora nocturna (adicional)</span><input id="vHoraNoc" type="number" step="0.01"></label>
          <label class="field"><span>Plus adicional</span><input id="plusAdi" type="number" step="0.01"></label>
          <label class="field"><span>Plus no remunerativo</span><input id="plusNR" type="number" step="0.01"></label>
          <label class="field"><span>Horas extra por jornada</span><input id="extraJornada" type="number" step="1"></label>
          <label class="field"><span>Sueldo básico</span><input id="sBasico" type="number" step="0.01"></label>
          <label class="field"><span>Presentismo</span><input id="presentismo" type="number" step="0.01"></label>
          <label class="field"><span>Viáticos</span><input id="viaticos" type="number" step="0.01"></label>
          <label class="field"><span>Horas nocturnas x día</span><input id="horasNocXD" type="number" step="1"></label>
        </div>
        <div class="modal-actions">
          <button id="btn-reset" class="btn btn-ghost">Restablecer</button>
          <div class="spacer"></div>
          <button id="btn-cancelar-opc" class="btn">Cancelar</button>
          <button id="btn-guardar-opc" class="btn btn-brand">Guardar</button>
        </div>
      </div>
    </div>

    <!-- MODAL Acerca de -->
    <div class="modal" id="modal-acerca">
      <div class="modal-card lg">
        <div class="brand" style="margin-bottom:8px">
          <img src="https://cdn.jsdelivr.net/gh/sanavera/sueldo-vigilador-web@main/ic_launcher.png" alt="" />
          <h1>Sueldo <span>Vigilador</span></h1>
        </div>

        <div style="margin:6px 0 14px; display:flex; gap:10px; align-items:center; flex-wrap:wrap">
          <strong>Desarrollador:</strong> <span>Sebastián Sanavera</span>
          <span style="opacity:.7">•</span>
          <span>Versión: <span class="chip" style="padding:4px 10px; border-radius:999px">Beta (modo prueba)</span></span>
        </div>

        <div class="card" style="margin-bottom:12px">
          <h2 style="margin:0 0 8px; font-size:18px">Código abierto</h2>
          <p class="sub" style="margin:0 0 8px">El código fuente está liberado para ver/editar/aprender:</p>
          <ul class="about-list">
            <li><a href="https://github.com/sanavera/sueldo-vigilador-web" target="_blank" rel="noopener">Repositorio en GitHub</a></li>
            <li><a href="https://sanavera.netlify.app/" target="_blank" rel="noopener">Sanavera MP3 - Otro proyecto</a></li>
          </ul>
        </div>

        <div class="card">
          <h2 style="margin:0 0 8px; font-size:18px">Fuentes de información</h2>
          <p class="sub" style="margin:0 8px 10px 0">Escalas salariales y normas consultadas:</p>
          <ul class="about-list">
            <li><a href="https://upsra.org.ar/" target="_blank" rel="noopener">UPSRA (Unión Personal de Seguridad)</a></li>
            <li><a href="https://www.lavozdelvigilador.com/" target="_blank" rel="noopener">La Voz del Vigilador</a></li>
            <li><a href="https://www.boletinoficial.gob.ar/" target="_blank" rel="noopener">Boletín Oficial de la República Argentina</a></li>
          </ul>
          <p class="sub" style="margin-top:10px">
            La app implementa: antigüedad 1% anual, extras 50%/100%, nocturnidad (0,1% del básico por hora), feriados según modalidad 12h/8-10h, y APOS 3% sobre sumas no remunerativas.
          </p>
        </div>

        <div class="modal-actions" style="margin-top:14px">
          <div class="spacer"></div>
          <button id="btn-cerrar-acerca" class="btn btn-brand">Entendido</button>
        </div>
      </div>
    </div>

    <footer class="footer-text">Desarrollado por Sebastián Sanavera ®</footer>
  </div>

  <!-- Lanzador + tooltip -->
  <div class="sv-chat-launcher" aria-live="polite">
    <div class="sv-tooltip" id="sv-tip">¿Querés charlar con el asistente?</div>
    <button class="sv-chat-btn" id="sv-open" aria-label="Abrir asistente">
      <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
        <path d="M2 3h20v14H7l-5 4V3z"></path>
      </svg>
    </button>
  </div>

  <!-- Modal Bot (sin header extra) -->
  <div class="sv-modal" id="sv-modal" aria-hidden="true">
    <div class="sv-backdrop" id="sv-backdrop"></div>
    <div class="sv-sheet" role="dialog" aria-modal="true" aria-labelledby="sv-title">
      <button class="sv-close" id="sv-close" aria-label="Cerrar asistente">Cerrar ✕</button>
      <div class="sv-body">
        <iframe id="sv-frame" title="Asistente"></iframe>
      </div>
    </div>
  </div>

  <script src="app.js"></script>

  <!-- ==== Lógica Bot flotante (aislada y sin romper nada) ==== -->
  <script>
    (function(){
      const OPEN_MS = 2600; // tiempo visible del globito
      const BOT_B64 = "aHR0cHM6Ly9sbG0tY2hhdC1hcHAtdGVtcGxhdGUuc2FuYXZlcmE3OC53b3JrZXJzLmRldi8="; // https://llm-chat-app-template.sanavera78.workers.dev/

      const $tip   = document.getElementById('sv-tip');
      const $open  = document.getElementById('sv-open');
      const $modal = document.getElementById('sv-modal');
      const $back  = document.getElementById('sv-backdrop');
      const $close = document.getElementById('sv-close');
      const $frame = document.getElementById('sv-frame');

      function showTip(){
        if(!$tip) return;
        $tip.classList.add('show');
        // Sonidito con WebAudio (si el navegador lo permite)
        try{
          const ctx = new (window.AudioContext || window.webkitAudioContext)();
          const o = ctx.createOscillator();
          const g = ctx.createGain();
          o.type = 'sine';
          o.frequency.value = 880;
          g.gain.setValueAtTime(0.001, ctx.currentTime);
          g.gain.exponentialRampToValueAtTime(0.08, ctx.currentTime + 0.02);
          g.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.15);
          o.connect(g).connect(ctx.destination);
          o.start();
          o.stop(ctx.currentTime + 0.16);
        }catch(e){}
        setTimeout(()=> $tip.classList.add('hide'), OPEN_MS);
        setTimeout(()=> { $tip.classList.remove('show','hide'); }, OPEN_MS + 250);
      }

      function openModal(){
        if(!$frame.src) $frame.src = atob(BOT_B64);
        $modal.classList.add('show');
        $modal.setAttribute('aria-hidden', 'false');
      }
      function closeModal(){
        $modal.classList.remove('show');
        $modal.setAttribute('aria-hidden', 'true');
      }

      // Eventos
      $open.addEventListener('click', openModal);
      $close.addEventListener('click', closeModal);
      $back.addEventListener('click', closeModal);
      document.addEventListener('keydown', (e)=>{
        if(e.key === 'Escape' && $modal.classList.contains('show')) closeModal();
      });

      // Mostrar tooltip luego de cargar todo
      window.addEventListener('load', ()=> setTimeout(showTip, 600));
    })();
  </script>
</body>
</html>
```0
